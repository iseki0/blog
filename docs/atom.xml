<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>isekiのNote</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.iseki.space/"/>
  <updated>2019-10-17T18:02:36.641Z</updated>
  <id>https://blog.iseki.space/</id>
  
  <author>
    <name>iseki</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>这里是iseki的笔记本呢</title>
    <link href="https://blog.iseki.space/2019/10/17/hello/"/>
    <id>https://blog.iseki.space/2019/10/17/hello/</id>
    <published>2019-10-17T23:30:00.000Z</published>
    <updated>2019-10-17T18:02:36.641Z</updated>
    
    <content type="html"><![CDATA[<p>我也不会写什么blog，那么，这里就当作一个笔记本用吧，毕竟有些东西，好不容易搞明白，忘记了还是很麻烦的呢。<br>要是能借机会帮到其他人，我也是很高兴的呢。</p><p>这里用Hexo驱动，Github 托管 + Cloudflare CDN 外加一份开源的主题，自己凑凑合合写个Github Action workflow（其实没有也无所谓啊），就算差不多能用了。<br>首页的链接嘛，基本都点不开（x</p><p>那么，就先这样了，最后，忘了说一句，既然你来了，那说明咱俩有缘啊（x</p><p>总之，欢迎光临了）x</p><p>满口胡话的iseki</p><p>2019.10.17</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;我也不会写什么blog，那么，这里就当作一个笔记本用吧，毕竟有些东西，好不容易搞明白，忘记了还是很麻烦的呢。&lt;br&gt;要是能借机会帮到其他人，我也是很高兴的呢。&lt;/p&gt;
&lt;p&gt;这里用Hexo驱动，Github 托管 + Cloudflare CDN 外加一份开源的主题，自己凑
      
    
    </summary>
    
    
    
      <category term="pin" scheme="https://blog.iseki.space/tags/pin/"/>
    
      <category term="text" scheme="https://blog.iseki.space/tags/text/"/>
    
  </entry>
  
  <entry>
    <title>在GitHub Action里设置 Hexo gen 的折腾笔记</title>
    <link href="https://blog.iseki.space/2019/10/17/github-action-hexo-gen/"/>
    <id>https://blog.iseki.space/2019/10/17/github-action-hexo-gen/</id>
    <published>2019-10-17T22:44:00.000Z</published>
    <updated>2019-10-17T18:02:36.641Z</updated>
    
    <content type="html"><![CDATA[<p>不想阅读Github Action厚重的文档，用预配置好的NPM Action折腾了半天，终以失败告终。由于不熟悉NPM和Node.js，最后爆出的错误摸不到头脑，就此作罢。</p><p>寻找另一个方法，在 <code>https://github.com/user/repo/actions/new</code> 中选择了跳过，自己设置一个空白的Workflow。</p><ol><li><p>为了避免Action重新推送仓库后循环触发Action（不知Github有没有对这种情况进行特殊处理）添加路径过滤器，仅当 <code>/source</code> 目录存在更新时才触发 Workflow</p></li><li><p>在仓库的 <code>Settings-&gt;Deploy keys</code> 里设置Github Action push时使用的SSH公钥，并赋予写权限，<code>Settings-&gt;Secrets</code> 里设置私钥的 Base64 编码。<br>私钥会通过环境变量传入Action的shell，<code>base64 -d</code> 即可解码，base64编码是为了避免潜在的回车换行符问题（环境变量里出现的换行符似乎不能正确地写入文件）</p></li><li><p>【未解决的疑问】 克隆git仓库后的所有操作最好写在一个step里，否则Git的工作目录可能莫名其妙的变空，猜测有可能是因为Step并不是严格的按顺序执行的？（这点没有仔细看文档所以不知道）总之写在一个Step里肯定就没问题了。</p></li><li><p><code>~/.ssh/id_rsa</code> 文件注意设定权限 <code>0600</code> 默认的权限过于宽松，SSH会不读取。</p></li><li><p><code>~/.ssh/config</code> 里需写入 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Host *</span><br><span class="line">    StrictHostKeyChecking no</span><br></pre></td></tr></table></figure></li></ol><p>否则可能会弹出要求确认SSH fingerprint的交互消息。</p><ol start="6"><li>记得设定 <code>git config --global user.name/email</code> 否则无法提交</li><li>如果使用了自定义的域名，注意 <code>CNAME</code> 文件是否在 <code>hexo clean</code> 后被删除，可能需要自己写回去。</li><li>注意部分Hexo主题可能以 git submodule 方式引入， Github Action 克隆仓库时不会自动克隆子模块，导致生成的所有页面空白，Hexo只会给出警告而不是错误。</li></ol><h3 id="附上自己写的workflow（糊成一坨，凑合能用）"><a href="#附上自己写的workflow（糊成一坨，凑合能用）" class="headerlink" title="附上自己写的workflow（糊成一坨，凑合能用）"></a>附上自己写的workflow（糊成一坨，凑合能用）</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Generate</span> <span class="string">Hexo</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line"><span class="attr">  push:</span> </span><br><span class="line"><span class="attr">    paths:</span> </span><br><span class="line"><span class="bullet">      -</span> <span class="string">'source/**'</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span> </span><br><span class="line"><span class="attr">  build:</span> </span><br><span class="line"><span class="attr">    name:</span> <span class="string">Refresh</span></span><br><span class="line"><span class="attr">    runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line"><span class="attr">    steps:</span></span><br><span class="line"><span class="attr">      - name:</span> <span class="string">Install</span> <span class="string">Node.js</span> <span class="string">and</span> <span class="string">NPM</span></span><br><span class="line"><span class="attr">        run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          sudo apt-get install curl -y</span></span><br><span class="line"><span class="string">          curl -sL https://deb.nodesource.com/setup_12.x | sudo -E bash -</span></span><br><span class="line"><span class="string">          sudo apt-get install nodejs -y</span></span><br><span class="line"><span class="string">          echo '=====Show NPM version====='</span></span><br><span class="line"><span class="string">          npm -v</span></span><br><span class="line"><span class="string">          echo '=====Show Node.js version====='</span></span><br><span class="line"><span class="string">          node -v</span></span><br><span class="line"><span class="string"></span><span class="attr">      - name:</span> <span class="string">Install</span> <span class="string">Hexo</span></span><br><span class="line"><span class="attr">        run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          sudo npm install -g hexo-cli</span></span><br><span class="line"><span class="string">          echo '=====Show HEXO version====='</span></span><br><span class="line"><span class="string">          hexo -v</span></span><br><span class="line"><span class="string"></span><span class="attr">      - name:</span> <span class="string">Prepare</span> <span class="string">Key</span> <span class="string">and</span> <span class="string">SSH</span> <span class="string">config</span></span><br><span class="line"><span class="attr">        run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          mkdir ~/.ssh</span></span><br><span class="line"><span class="string">          echo $DEPLOY_PRIVKEY | base64 -d &gt; ~/.ssh/id_rsa</span></span><br><span class="line"><span class="string">          chmod 0600 ~/.ssh/id_rsa</span></span><br><span class="line"><span class="string">          echo 'Host *' &gt;&gt; ~/.ssh/config</span></span><br><span class="line"><span class="string">          echo '    StrictHostKeyChecking no' &gt;&gt; ~/.ssh/config</span></span><br><span class="line"><span class="string">          chmod 0600 ~/.ssh/config</span></span><br><span class="line"><span class="string"></span><span class="attr">        env:</span> </span><br><span class="line"><span class="attr">          DEPLOY_PRIVKEY:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.DEPLOY_PRIVKEY</span> <span class="string">&#125;&#125;</span></span><br><span class="line"><span class="attr">      - name:</span> <span class="string">Clone</span> <span class="string">git</span> <span class="string">repo</span></span><br><span class="line"><span class="attr">        run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          cd ~</span></span><br><span class="line"><span class="string">          echo '=====Show work path====='</span></span><br><span class="line"><span class="string">          pwd</span></span><br><span class="line"><span class="string">          git clone git@github.com:cpdyj/blog.git</span></span><br><span class="line"><span class="string">          cd blog</span></span><br><span class="line"><span class="string">          ls</span></span><br><span class="line"><span class="string">          echo '=====Show work path====='</span></span><br><span class="line"><span class="string">          pwd</span></span><br><span class="line"><span class="string">          cat ./package.json</span></span><br><span class="line"><span class="string">          npm install</span></span><br><span class="line"><span class="string">          npm audit fix</span></span><br><span class="line"><span class="string">          hexo clean</span></span><br><span class="line"><span class="string">          hexo g</span></span><br><span class="line"><span class="string">          echo "blog.iseki.space" &gt; ./docs/CNAME</span></span><br><span class="line"><span class="string">          git config --global user.name "User name"</span></span><br><span class="line"><span class="string">          git config --global user.email "Email@example.com"</span></span><br><span class="line"><span class="string">          git add docs</span></span><br><span class="line"><span class="string">          git commit -am "Auto generate on Github Action at `date`"</span></span><br><span class="line"><span class="string">          git push</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;不想阅读Github Action厚重的文档，用预配置好的NPM Action折腾了半天，终以失败告终。由于不熟悉NPM和Node.js，最后爆出的错误摸不到头脑，就此作罢。&lt;/p&gt;
&lt;p&gt;寻找另一个方法，在 &lt;code&gt;https://github.com/user/re
      
    
    </summary>
    
    
    
      <category term="github" scheme="https://blog.iseki.space/tags/github/"/>
    
      <category term="action" scheme="https://blog.iseki.space/tags/action/"/>
    
      <category term="nodejs" scheme="https://blog.iseki.space/tags/nodejs/"/>
    
      <category term="npm" scheme="https://blog.iseki.space/tags/npm/"/>
    
      <category term="hexo" scheme="https://blog.iseki.space/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>关于Kotlin注解处理器的一些坑</title>
    <link href="https://blog.iseki.space/2019/10/14/kotlin-kapt-note/"/>
    <id>https://blog.iseki.space/2019/10/14/kotlin-kapt-note/</id>
    <published>2019-10-14T00:34:14.000Z</published>
    <updated>2019-10-17T18:02:36.641Z</updated>
    
    <content type="html"><![CDATA[<ol><li><p>kapt 1.3.5 存在bug，不能用，连同 kotlin-gradle-plugin 一同降级到 1.3.41</p></li><li><p><code>build.gradle.kts</code> 中 <code>dependencies</code> 需要同时使用 <code>implementation</code> 和 <code>kapt</code> 引用 <code>com.google.auto.service:auto-service</code> ，否则无法识别使用Kotlin编写的注解处理器</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dependencies&#123;</span><br><span class="line">    implementation(<span class="string">"com.google.auto.service:auto-service:<span class="variable">$googleAutoServiceVersion</span>"</span>)</span><br><span class="line">    kapt(<span class="string">"com.google.auto.service:auto-service:<span class="variable">$googleAutoServiceVersion</span>"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>如果使用注解的类、函数签名、注解参数等包含顶级包声明的内容，javac可能出现找不到符号异常。不确定是不是bug。由于Windows下jdk可能使用中文locale，idea中Build中文报错可能显示成乱码，可以在Terminal中运行 <code>gradlew build</code> 查看错误原因（Terminal的文字编码是正确的）。</p></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ol&gt;
&lt;li&gt;&lt;p&gt;kapt 1.3.5 存在bug，不能用，连同 kotlin-gradle-plugin 一同降级到 1.3.41&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;build.gradle.kts&lt;/code&gt; 中 &lt;code&gt;dependencies&lt;/c
      
    
    </summary>
    
    
    
      <category term="kotlin" scheme="https://blog.iseki.space/tags/kotlin/"/>
    
      <category term="kapt" scheme="https://blog.iseki.space/tags/kapt/"/>
    
      <category term="java" scheme="https://blog.iseki.space/tags/java/"/>
    
      <category term="idea" scheme="https://blog.iseki.space/tags/idea/"/>
    
      <category term="gradle" scheme="https://blog.iseki.space/tags/gradle/"/>
    
  </entry>
  
</feed>
